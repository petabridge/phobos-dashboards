{"title":"Akka.Cluster Metrics and Status - Phobos 2.3","description":"## Akka.Cluster Metrics and Status\n\nData is powered by [Phobos 2.3](https://phobos.petabridge.com/) and [OpenTelemetry](https://opentelemetry.io/)\n\n- [Latest source code for this dashboard](https://github.com/petabridge/phobos-dashboards/blob/master/datadog/phobos-2.x/phobos-akka.net-cluster-metrics-datadog.json)\n- [Phobos Dashboards](https://github.com/petabridge/phobos-dashboards)","widgets":[{"id":5186181404310320,"definition":{"title":"Cluster Status","type":"group","layout_type":"ordered","widgets":[{"id":608204519904482,"definition":{"title":"Up","title_size":"16","title_align":"left","type":"query_value","requests":[{"formulas":[{"formula":"query1"}],"response_format":"scalar","queries":[{"query":"avg:akka.cluster.members{status:up}","data_source":"metrics","name":"query1","aggregator":"avg"}]}],"autoscale":true,"precision":0}},{"id":4029195276399106,"definition":{"title":"WeaklyUp","title_size":"16","title_align":"left","type":"query_value","requests":[{"formulas":[{"formula":"query1"}],"response_format":"scalar","queries":[{"query":"avg:akka.cluster.members{status:weaklyup}","data_source":"metrics","name":"query1","aggregator":"avg"}]}],"autoscale":true,"precision":0}},{"id":2636277250178444,"definition":{"title":"Joining","title_size":"16","title_align":"left","type":"query_value","requests":[{"formulas":[{"formula":"query1"}],"response_format":"scalar","queries":[{"query":"avg:akka.cluster.members{status:joining}","data_source":"metrics","name":"query1","aggregator":"avg"}]}],"autoscale":true,"precision":0}},{"id":266129724310144,"definition":{"title":"Leaving","title_size":"16","title_align":"left","type":"query_value","requests":[{"formulas":[{"formula":"query1"}],"response_format":"scalar","queries":[{"query":"avg:akka.cluster.members{status:leaving}","data_source":"metrics","name":"query1","aggregator":"avg"}]}],"autoscale":true,"precision":0}},{"id":4995580184674300,"definition":{"title":"Exiting","title_size":"16","title_align":"left","type":"query_value","requests":[{"formulas":[{"formula":"query1"}],"response_format":"scalar","queries":[{"query":"avg:akka.cluster.members{status:exiting}","data_source":"metrics","name":"query1","aggregator":"avg"}]}],"autoscale":true,"precision":0}},{"id":2970419279880540,"definition":{"title":"Down","title_size":"16","title_align":"left","type":"query_value","requests":[{"formulas":[{"formula":"query1"}],"response_format":"scalar","queries":[{"query":"avg:akka.cluster.members{status:down}","data_source":"metrics","name":"query1","aggregator":"avg"}]}],"autoscale":true,"precision":0}},{"id":78312806918124,"definition":{"title":"Unreachable","title_size":"16","title_align":"left","type":"query_value","requests":[{"formulas":[{"formula":"query1"}],"conditional_formats":[{"comparator":">","palette":"white_on_red","value":0},{"comparator":"<=","palette":"white_on_green","value":0}],"response_format":"scalar","queries":[{"query":"avg:akka.cluster.reachable{status:false}","data_source":"metrics","name":"query1","aggregator":"avg"}]}],"autoscale":true,"precision":0}},{"id":652788401399832,"definition":{"title":"Cluster Nodes by Status","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"vertical","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"response_format":"timeseries","queries":[{"query":"avg:akka.cluster.members{*} by {status}","data_source":"metrics","name":"query1"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":true,"scale":"linear","label":"","min":"auto","max":"auto"},"markers":[]}}]}},{"id":8289578796259032,"definition":{"title":"Logging and Error Rates","type":"group","layout_type":"ordered","widgets":[{"id":7817897741002224,"definition":{"title":"Cluster Logging Activity","title_size":"16","title_align":"left","show_legend":false,"legend_layout":"vertical","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"response_format":"timeseries","on_right_yaxis":false,"queries":[{"query":"sum:akka.logs{$address,$Role} by {level}.as_count()","data_source":"metrics","name":"query1"}],"style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"bars"}],"yaxis":{"include_zero":true,"scale":"linear","label":"","min":"auto","max":"auto"},"markers":[]}},{"id":121001245767790,"definition":{"title":"Exceptions by Type","title_size":"16","title_align":"left","type":"query_table","requests":[{"formulas":[{"alias":"Total Exception Count","limit":{"count":500,"order":"desc"},"formula":"exclude_null(query1)"}],"response_format":"scalar","queries":[{"query":"sum:akka.logs{$address,$Role} by {exceptiontype,cluster_role,akka_address}.as_count()","data_source":"metrics","name":"query1","aggregator":"avg"}]}]}},{"id":7491418707592930,"definition":{"title":"Total Error Logged (as Rate over Timeframe)","title_size":"16","title_align":"left","type":"query_value","requests":[{"formulas":[{"formula":"query1"}],"response_format":"scalar","queries":[{"query":"sum:akka.logs{level:error,$address,$Role}.as_count()","data_source":"metrics","name":"query1","aggregator":"avg"}]}],"autoscale":true,"custom_unit":"err","precision":0}}]}},{"id":7496223314946186,"definition":{"title":"Actor Metrics","type":"group","layout_type":"ordered","widgets":[{"id":4237186823649708,"definition":{"title":"Total Actor Throughput (msg/s)","title_size":"16","title_align":"left","type":"query_value","requests":[{"formulas":[{"formula":"query1"}],"response_format":"scalar","queries":[{"query":"sum:akka.messages.recv{$address,$Role}.as_rate()","data_source":"metrics","name":"query1","aggregator":"avg"}]}],"autoscale":true,"custom_unit":"rq/s","precision":2}},{"id":5101545149322736,"definition":{"title":"Live Actors by Type (Top 10)","title_size":"16","title_align":"left","type":"query_table","requests":[{"formulas":[{"alias":"Created","cell_display_mode":"bar","limit":{"count":500,"order":"desc"},"formula":"exclude_null(query1)"},{"alias":"Terminated","cell_display_mode":"bar","formula":"exclude_null(query2)"}],"response_format":"scalar","queries":[{"query":"sum:akka.actor.created{$address,$Role} by {actortype}.as_count()","data_source":"metrics","name":"query1","aggregator":"max"},{"query":"sum:akka.actor.stopped{$address,$Role} by {actortype}.as_count()","data_source":"metrics","name":"query2","aggregator":"max"}]}],"has_search_bar":"auto"}},{"id":8963261864632544,"definition":{"title":"Actor Crashes by Actor / Exception (Top 10)","title_size":"16","title_align":"left","type":"query_table","requests":[{"formulas":[{"alias":"Total Crashes","cell_display_mode":"bar","limit":{"count":500,"order":"desc"},"formula":"query1"}],"response_format":"scalar","queries":[{"query":"sum:akka.actor.restarts{*} by {actortype,exceptiontype}.as_count()","data_source":"metrics","name":"query1","aggregator":"last"}]}],"has_search_bar":"auto"}},{"id":4587859339946356,"definition":{"title":"Akka.NET Message Throughput by Type  (Top 10)","title_size":"16","title_align":"left","type":"query_table","requests":[{"formulas":[{"alias":"msg/s","cell_display_mode":"bar","limit":{"count":500,"order":"desc"},"formula":"exclude_null(query1)"}],"response_format":"scalar","queries":[{"query":"sum:akka.messages.recv{*} by {messagetype}.as_rate()","data_source":"metrics","name":"query1","aggregator":"avg"}]}],"has_search_bar":"auto"}},{"id":4333569625554228,"definition":{"title":"Akka.NET Message Totals by Type (Top 10 over 5 Minutes)","title_size":"16","title_align":"left","type":"query_table","requests":[{"formulas":[{"alias":"Count (5m)","cell_display_mode":"bar","limit":{"count":500,"order":"desc"},"formula":"exclude_null(query1)"}],"response_format":"scalar","queries":[{"query":"sum:akka.messages.recv{$address,$Role} by {messagetype}.as_count().rollup(avg, 300)","data_source":"metrics","name":"query1","aggregator":"sum"}]}],"has_search_bar":"auto"}},{"id":8397291270629783,"definition":{"title":"Total Akka.NET Actors","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"time":{},"type":"timeseries","requests":[{"formulas":[{"alias":"Total Actors","formula":"query1"}],"queries":[{"name":"query1","data_source":"metrics","query":"sum:akka.actor.live{$Role,$address} by {cluster_role,akka_address}"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]}},{"id":3120853577956795,"definition":{"title":"Live Actors by Type (Top 10)","title_size":"16","title_align":"left","time":{},"type":"query_table","requests":[{"response_format":"scalar","formulas":[{"alias":"Alive","conditional_formats":[{"comparator":"<","palette":"white_on_green","value":80},{"comparator":">=","palette":"white_on_red","value":80}],"cell_display_mode":"number","formula":"query1","limit":{"count":10,"order":"desc"}}],"queries":[{"name":"query1","data_source":"metrics","query":"sum:akka.actor.live{$Role,$address} by {actortype}","aggregator":"last"}]}]}}]}},{"id":8905864203480100,"definition":{"title":"Cluster Sharding Metrics","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":7295436179196066,"definition":{"title":"Entity Distribution [$shardRegion]","title_size":"16","title_align":"left","time":{},"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"query":"sum:akka.cluster.sharding.entities{$shardRegion} by {akka_address}","data_source":"metrics","name":"query1"}],"formulas":[{"formula":"query1"}],"style":{"palette":"classic"},"display_type":"line"}]}},{"id":6022771968343963,"definition":{"title":"Entity Distribution [$shardRegion]","title_size":"16","title_align":"left","time":{},"type":"query_table","requests":[{"queries":[{"data_source":"metrics","name":"query1","query":"sum:akka.cluster.sharding.entities{$shardRegion} by {akka_address}","aggregator":"last"}],"formulas":[{"conditional_formats":[{"comparator":"<","palette":"white_on_green","value":1000},{"comparator":">=","palette":"white_on_red","value":1000}],"cell_display_mode":"bar","alias":"Entities","formula":"query1","limit":{"count":500,"order":"desc"}}],"response_format":"scalar"}],"has_search_bar":"auto"}},{"id":3566708346645853,"definition":{"title":"Shard Distribution [$shardRegion]","title_size":"16","title_align":"left","time":{},"requests":[{"response_format":"scalar","formulas":[{"formula":"query1","limit":{"order":"desc"}}],"queries":[{"query":"sum:akka.cluster.sharding.shards{$shardRegion} by {akka_address}","data_source":"metrics","name":"query1","aggregator":"last"}],"style":{"palette":"datadog16"}}],"type":"sunburst","hide_total":true,"legend":{"type":"automatic"}}},{"id":6809949581311686,"definition":{"title":"Shard Distribution [$shardRegion]","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"time":{},"type":"timeseries","requests":[{"formulas":[{"formula":"query1"}],"queries":[{"name":"query1","data_source":"metrics","query":"sum:akka.cluster.sharding.shards{$shardRegion} by {akka_address}"}],"response_format":"timeseries","style":{"palette":"dog_classic","line_type":"solid","line_width":"normal"},"display_type":"line"}]}}]}}],"template_variables":[{"name":"address","default":"*","prefix":"akka_address","available_values":[]},{"name":"Role","default":"*","prefix":"cluster_role","available_values":[]},{"name":"shardRegion","prefix":"region","available_values":[],"default":"*"}],"layout_type":"ordered","is_read_only":false,"notify_list":[],"reflow_type":"auto","id":"zwv-b7a-sb7"}